# ═══════════════════════════════════════════════════════════════
# clickterm - tmux configuration
# Mouse-driven development environment
# ═══════════════════════════════════════════════════════════════

# ─────────────────────────────────────────────────────────────────
# CORE SETTINGS
# ─────────────────────────────────────────────────────────────────

# Enable mouse support (click, drag, scroll)
set -g mouse on

# Initialize new panes with clickterm shell setup (welcome screen + aliases)
set -g default-command 'bash --init-file ~/.config/clickterm/shell-init.sh'

# Start pane/window numbering at 1
set -g base-index 1
set -g pane-base-index 1

# Don't rename windows automatically
set -g allow-rename off

# Increase scrollback buffer
set -g history-limit 10000

# Reduce escape time for faster input processing (0 = no delay)
set -sg escape-time 0

# ─────────────────────────────────────────────────────────────────
# TERMINAL TITLE
# ─────────────────────────────────────────────────────────────────

# Set terminal title to "clickterm" (appears in iTerm2 tab/title bar)
set -g set-titles on
set -g set-titles-string "clickterm"

# ─────────────────────────────────────────────────────────────────
# PERFORMANCE & SMOOTHNESS
# ─────────────────────────────────────────────────────────────────

# Set terminal type for optimal rendering
set -g default-terminal "tmux-256color"

# Enable true color (RGB) support for iTerm2
set -as terminal-features ",xterm-256color:RGB"
set -as terminal-overrides ",xterm-256color:Tc"

# Aggressive resize - constrain only to smallest *active* client
set -g aggressive-resize on

# Enable focus events for better terminal synchronization
set -g focus-events on

# ─────────────────────────────────────────────────────────────────
# THEME - Nord
# ─────────────────────────────────────────────────────────────────

source-file ~/.config/clickterm/tmux-theme.conf

# ─────────────────────────────────────────────────────────────────
# BUTTON CLICK HANDLERS
# ─────────────────────────────────────────────────────────────────

# Handle all status bar clicks via dispatcher script
bind -n MouseUp1Status run-shell '~/.config/clickterm/dispatch.sh "#{mouse_status_range}"'

# ─────────────────────────────────────────────────────────────────
# MOUSE BEHAVIOR
# ─────────────────────────────────────────────────────────────────

# Click pane to select
bind -n MouseDown1Pane select-pane -t =

# Drag border to resize
bind -n MouseDrag1Border resize-pane -M

# Scroll with mousewheel
bind -n WheelUpPane if-shell -F "#{||:#{pane_in_mode},#{mouse_any_flag}}" \
    "send-keys -M" \
    "copy-mode -e"

# ═══════════════════════════════════════════════════════════════
# END clickterm configuration
# ═══════════════════════════════════════════════════════════════
